<div class="jumbotron" *ngIf="hero">
  <div class="row">
    <div class="col-12">
      <h1 class="display-3 float-left">{{hero.name}}</h1>
      <button type="button" class="btn btn-outline-info float-right" (click)="openUpdateHeroModal(contentHero)">{{ 'BUTTONS.HERO.UPDATE_HERO' | translate }}</button>
    </div>
  </div>

  <div class="row">
    <div class="col-md-5">
      <img class="img-fluid mb-3" src="{{hero.imagePreview.data}}" alt="{{hero.imagePreview.name}}" *ngIf="hero.imagePreview">

      <div class="alert alert-dismissible alert-primary">
        <h4>Gallery</h4>

        <div class="plain-container-row" *ngIf="images.length">
          <ng-container *ngFor="let img of images; let i = index">
            <div *ngIf="i <= 2">
              <img *ngIf="img.plain && img.plain.img; else noThumb"
                   class="my-app-custom-image-row"
                   [src]="img.plain.img"
                   (click)="ksGalleryService.openImageModalRow(img, images)"
                   [alt]="img.modal.description"/>

              <a class="more" *ngIf="i==2 && i>0" (click)="ksGalleryService.openImageModalRow(img, images)"> +{{images.length - 3}} more </a>

              <ng-template #noThumb>
                <span class="cover-custom-image-row">
                  <img class="custom-image-row"
                       [src]="img.modal.img"
                       (click)="ksGalleryService.openImageModalRow(img, images)"
                       [alt]="img.modal.description"/>
                </span>
              </ng-template>
            </div>
          </ng-container>
        </div>
        <ks-modal-gallery
          [id]="0"
          [modalImages]="images"
          [buttonsConfig]="ksGalleryService.buttonsConfigFull"
          [enableCloseOutside]="false"
          [plainGalleryConfig]="ksGalleryService.customPlainGalleryRowConfig"
          [previewConfig]="{visible: true, number: 5}"
          [slideConfig]="{infinite: true}"
          [currentImageConfig]="{loadingConfig: {enable: true, type: 4}}">
        </ks-modal-gallery>

        <div class="text-center font-weight-normal text-danger" *ngIf="!images.length">{{ 'COMMON.CONTENT.EMPTY_GALLERY' | translate }}</div>
      </div>
    </div>

    <div class="col-md-7">
      <p class="lead">{{hero.description}}</p>
    </div>
  </div>
</div>

<ng-template #contentHero>
  <div class="modal-header">
    <h4 class="modal-title" id="modal-basic-title">{{ 'PAGES.BOOK.HERO.MODAL.UPDATE_TITLE' | translate }}</h4>
    <button type="button" class="close" aria-label="Close" (click)="closeUpdateHeroModal()">
      <img src="../../../../assets/icons/close.png" alt="Close">
    </button>
  </div>

  <div class="modal-body">
    <form [formGroup]="form">
      <div class="form-group">
        <label for="field-name">{{ 'COMMON.FIELDS.NAME' | translate }}</label>
        <input type="text" class="form-control" [ngClass]="{'is-valid': form.get('name').valid && form.get('name').touched, 'is-invalid': form.get('name').invalid && form.get('name').touched}" id="field-name" formControlName="name" placeholder="{{ 'COMMON.FIELDS.NAME_PLACEHOLDER' | translate }}">
        <small class="form-text text-danger" *ngIf="form.get('name').invalid && form.get('name').touched">
          <span *ngIf="form.get('name').errors.required">{{ 'ERRORS.FIELDS.REQUIRED' | translate }}</span>
        </small>
      </div>

      <div class="form-group">
        <label for="field-description">{{ 'COMMON.FIELDS.DESCRIPTION' | translate }}</label>
        <textarea class="form-control" [ngClass]="{'is-valid': form.get('description').valid && form.get('description').touched, 'is-invalid': form.get('description').invalid && form.get('description').touched}" id="field-description" rows="3" formControlName="description" placeholder="{{ 'COMMON.FIELDS.DESCRIPTION_PLACEHOLDER' | translate }}"></textarea>
        <small class="form-text text-danger" *ngIf="form.get('description').invalid && form.get('description').touched">
          <span *ngIf="form.get('description').errors.required">{{ 'ERRORS.FIELDS.REQUIRED' | translate }}</span>
        </small>
      </div>

      <div class="form-group">
        <label for="image-preview">Preview</label>
        <file-pond
          id="image-preview"
          [options]="pondOptionsPreview"
          [files]="pondFilesPreview"
          (onaddfile)="pondHandleAddFilePreview($event)"
          (onremovefile)="poundHandleRemoveFilePreview($event)">
        </file-pond>
      </div>

      <div class="form-group">
        <label for="image-gallery">Gallery</label>
        <file-pond
          id="image-gallery"
          [options]="pondOptionsGallery"
          [files]="pondFilesGallery"
          (onaddfile)="pondHandleAddFileGallery($event)"
          (onremovefile)="poundHandleRemoveFileGallery($event)">
        </file-pond>
      </div>
    </form>
  </div>

  <div class="modal-footer">
    <button type="button" ngbAutofocus class="btn btn-outline-success" [disabled]="form.invalid" (click)="updateHero()">{{ 'BUTTONS.COMMON.UPDATE' | translate }}</button>
  </div>
</ng-template>

<div class="jumbotron" *ngIf="hero">
  <div class="row">
    <div class="col-12">
      <h3>Content</h3>

      <div [froalaEditor]="froalaOptions" [froalaModel]="froalaContent"></div>
    </div>
  </div>
</div>
